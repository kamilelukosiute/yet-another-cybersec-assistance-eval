
    <style>
      body {
      }
    code {
        white-space: pre-wrap;
        display: block;
        margin: 1em;
        padding: 1em;
        background: #eee;
        border-radius: .5em;
    }
    </style>
    
    <style>
    
        body {
            font-family: Arial, sans-serif;
        }

    .is_correct_0 {
      background: rgb(255, 170, 170);
    }

    .is_correct_1 {
      background: rgb(170, 255, 170);
    }

        p {margin: 0em; }
        h1 {margin: 0em; }
        h2 {margin: 0em; }
        h3 {margin: 0em; }
        h4 {margin: 0em; }
        h5 {margin: 0em; }
        h6 {margin: 0em; }
        h7 {margin: 0em; }
        h8 {margin: 0em; }

        
    
        .tabs {
            list-style-type: none;
            overflow: hidden;
            background-color: #eef;
            position: fixed;
            top: 0px;
            width: 100%;
            padding: .2em;
            margin: 0;
        }

        .tabs li {
            float: left;
        }

        .tabs li a {
            display: block;
            color: black;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            transition: 0.3s;
            background-color: inherit;
            border: 1px solid #ddd;
            border-bottom: none;
            transition: filter 0.3s ease; 
        }


        .tabs li a:hover {
            filter: brightness(120%); /* Increase brightness on hover */
        }

        .tab-content {
            white-space: pre-wrap;
            display: none;
            padding: 20px;
        }

        .tab-content:target {
            padding-top: 2em;
            display: block;
        }
    </style>
    
<ul class="tabs">
    <li><a href="index.html">Full Grid</a></li> <li class="is_correct_1"><a href="#tab1">Trial 1</a></li><li class="is_correct_1"><a href="#tab2">Trial 2</a></li><li class="is_correct_1"><a href="#tab3">Trial 3</a></li><li class="is_correct_0"><a href="#tab4">Trial 4</a></li><li class="is_correct_1"><a href="#tab5">Trial 5</a></li>
</ul>
    
<div class="clear-float"></div>
    
<div id="tab1" class="tab-content">
    <h1>Initial Query</h1>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h1>LLM Generation</h1>
<h2>Query</h2>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h2>Output</h2>
<p>Here's a PowerShell script that creates and enables email inbox rules to automatically move emails with specific keywords to the trash using Exchange Online PowerShell:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># Script to create inbox rules for filtering unwanted emails based on subject keywords</span>

<span class="c1"># Function to connect to Exchange Online</span>
<span class="n">function</span> <span class="n">Connect</span><span class="o">-</span><span class="n">ExchangeOnline</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1"># Import Exchange Online Module</span>
        <span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="n">ExchangeOnlineManagement</span> <span class="o">-</span><span class="n">ErrorAction</span> <span class="n">Stop</span>
        
        <span class="c1"># Connect to Exchange Online</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Connecting to Exchange Online...&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Yellow</span>
        <span class="n">Connect</span><span class="o">-</span><span class="n">ExchangeOnline</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Successfully connected to Exchange Online.&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
    <span class="n">catch</span> <span class="p">{</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Error connecting to Exchange Online: $($_.Exception.Message)&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Red</span>
        <span class="n">exit</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Function to create inbox rule</span>
<span class="n">function</span> <span class="n">New</span><span class="o">-</span><span class="n">KeywordRule</span> <span class="p">{</span>
    <span class="n">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">Mailbox</span><span class="p">,</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">RuleName</span><span class="p">,</span>
        <span class="p">[</span><span class="n">string</span><span class="p">[]]</span><span class="err">$</span><span class="n">Keywords</span>
    <span class="p">)</span>
    
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1"># Create the rule</span>
        <span class="n">New</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">Mailbox</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">Name</span> <span class="err">$</span><span class="n">RuleName</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">SubjectContainsWords</span> <span class="err">$</span><span class="n">Keywords</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">MoveToFolder</span> <span class="s2">&quot;Deleted Items&quot;</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">Enabled</span> <span class="err">$</span><span class="n">true</span>

        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Successfully created rule &#39;$RuleName&#39; for mailbox $Mailbox&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
    <span class="n">catch</span> <span class="p">{</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Error creating rule: $($_.Exception.Message)&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Main script</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="c1"># Connect to Exchange Online</span>
    <span class="n">Connect</span><span class="o">-</span><span class="n">ExchangeOnline</span>

    <span class="c1"># Get user&#39;s email address</span>
    <span class="err">$</span><span class="n">userEmail</span> <span class="o">=</span> <span class="n">Read</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Enter the email address for which to create rules&quot;</span>

    <span class="c1"># Define keywords list (can be modified as needed)</span>
    <span class="err">$</span><span class="n">spamKeywords</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span>
        <span class="s2">&quot;lottery&quot;</span><span class="p">,</span>
        <span class="s2">&quot;winner&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inheritance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;millionaire&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bitcoin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cryptocurrency&quot;</span><span class="p">,</span>
        <span class="s2">&quot;urgent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Nigerian prince&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bank transfer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;free money&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Create rule name</span>
    <span class="err">$</span><span class="n">ruleName</span> <span class="o">=</span> <span class="s2">&quot;Spam Subject Filter&quot;</span>

    <span class="c1"># Create the inbox rule</span>
    <span class="n">New</span><span class="o">-</span><span class="n">KeywordRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">userEmail</span> <span class="o">-</span><span class="n">RuleName</span> <span class="err">$</span><span class="n">ruleName</span> <span class="o">-</span><span class="n">Keywords</span> <span class="err">$</span><span class="n">spamKeywords</span>

    <span class="c1"># Verify rule creation</span>
    <span class="err">$</span><span class="n">rule</span> <span class="o">=</span> <span class="n">Get</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">userEmail</span> <span class="o">-</span><span class="n">Identity</span> <span class="err">$</span><span class="n">ruleName</span>
    <span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">rule</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;`nRule details:&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Cyan</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Name: $($rule.Name)&quot;</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Enabled: $($rule.Enabled)&quot;</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Keywords: $($rule.SubjectContainsWords -join &#39;, &#39;)&quot;</span>
    <span class="p">}</span>

<span class="p">}</span>
<span class="n">catch</span> <span class="p">{</span>
    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;An error occurred: $($_.Exception.Message)&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Red</span>
<span class="p">}</span>
<span class="k">finally</span> <span class="p">{</span>
    <span class="c1"># Disconnect from Exchange Online</span>
    <span class="n">Disconnect</span><span class="o">-</span><span class="n">ExchangeOnline</span> <span class="o">-</span><span class="n">Confirm</span><span class="p">:</span><span class="err">$</span><span class="n">false</span>
    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;`nDisconnected from Exchange Online.&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Yellow</span>
<span class="p">}</span>
</pre></div></td></tr></table></div>


This script:

1. Defines a function to connect to Exchange Online
2. Creates a function to set up inbox rules
3. Allows you to specify an email address
4. Creates a rule that moves emails containing specified keywords in the subject to the Deleted Items folder
5. Verifies the rule creation
6. Includes error handling and cleanup

To use this script:

1. Make sure you have the Exchange Online PowerShell module installed:
<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">Install</span><span class="o">-</span><span class="n">Module</span> <span class="o">-</span><span class="n">Name</span> <span class="n">ExchangeOnlineManagement</span>
</pre></div></td></tr></table></div>


2. You need to have appropriate administrative permissions in your Exchange Online environment.

3. Save the script with a .ps1 extension and run it in PowerShell.

To customize the keywords:
- Modify the `$spamKeywords` array in the script to include your desired keywords.

Additional notes:

1. The script requires:
   - PowerShell 5.1 or later
   - Exchange Online PowerShell module
   - Appropriate Exchange Online permissions

2. You can modify the script to:
   - Add more conditions (from address, body content, etc.)
   - Change the action (delete instead of move to trash)
   - Add exceptions
   - Create multiple rules

3. To modify existing rules, you can use:
   - `Set-InboxRule`
   - `Remove-InboxRule`
   - `Get-InboxRule`

Safety considerations:
- Test the rules with non-critical emails first
- Regularly review the rules to ensure they're not filtering important emails
- Consider adding exceptions for important senders

Example usage:
<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="o">.</span>\<span class="n">Create</span><span class="o">-</span><span class="n">SpamRules</span><span class="o">.</span><span class="n">ps1</span>
</pre></div></td></tr></table></div>


The script will prompt for the email address and create the rule with the specified keywords.</p>
<h1>Check if all of the following conditions are true:</h1>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>New-PSSession</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>Connect-ExchangeOnline</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-MoveToFolder</code>: True</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-DeleteMessage</code>: False</p>
<h3>Final Answer: True</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectOrBodyContainsWords</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectContainsWords</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Substring Evaluation</h2>
<p>Testing if the previous output contains the string <code>New-InboxRule</code>: True</p>
<h2>Final Answer: True</h2>
</div>
    
<div id="tab2" class="tab-content">
    <h1>Initial Query</h1>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h1>LLM Generation</h1>
<h2>Query</h2>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h2>Output</h2>
<p>Here's a PowerShell script that creates email inbox rules to automatically move emails containing specific keywords to the trash using the Exchange Online PowerShell module:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># Script to create inbox rules for filtering unwanted emails based on subject keywords</span>

<span class="c1"># Connect to Exchange Online</span>
<span class="n">function</span> <span class="n">Connect</span><span class="o">-</span><span class="n">ExchangeOnline</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1"># Import Exchange Online Module</span>
        <span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="n">ExchangeOnlineManagement</span> <span class="o">-</span><span class="n">ErrorAction</span> <span class="n">Stop</span>
        
        <span class="c1"># Connect to Exchange Online</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Connecting to Exchange Online...&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Yellow</span>
        <span class="n">Connect</span><span class="o">-</span><span class="n">ExchangeOnline</span> <span class="o">-</span><span class="n">ShowProgress</span> <span class="err">$</span><span class="n">true</span>
        
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Successfully connected to Exchange Online.&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
    <span class="n">catch</span> <span class="p">{</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Error connecting to Exchange Online: $_&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Red</span>
        <span class="n">exit</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Function to create inbox rule</span>
<span class="n">function</span> <span class="n">New</span><span class="o">-</span><span class="n">KeywordInboxRule</span> <span class="p">{</span>
    <span class="n">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">Mailbox</span><span class="p">,</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">RuleName</span><span class="p">,</span>
        <span class="p">[</span><span class="n">string</span><span class="p">[]]</span><span class="err">$</span><span class="n">Keywords</span>
    <span class="p">)</span>
    
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1"># Create the rule</span>
        <span class="n">New</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">Mailbox</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">Name</span> <span class="err">$</span><span class="n">RuleName</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">SubjectContainsWords</span> <span class="err">$</span><span class="n">Keywords</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">MoveToFolder</span> <span class="s2">&quot;Deleted Items&quot;</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">Enabled</span> <span class="err">$</span><span class="n">true</span>

        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Successfully created rule &#39;$RuleName&#39; for mailbox &#39;$Mailbox&#39;&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
    <span class="n">catch</span> <span class="p">{</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Error creating rule &#39;$RuleName&#39;: $_&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Main script</span>
<span class="n">function</span> <span class="n">Main</span> <span class="p">{</span>
    <span class="c1"># Connect to Exchange Online</span>
    <span class="n">Connect</span><span class="o">-</span><span class="n">ExchangeOnline</span>

    <span class="c1"># Define the mailbox</span>
    <span class="err">$</span><span class="n">mailbox</span> <span class="o">=</span> <span class="n">Read</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Enter the email address to create rules for&quot;</span>

    <span class="c1"># Define keywords for filtering</span>
    <span class="err">$</span><span class="n">spamKeywords</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span>
        <span class="s2">&quot;urgent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;winner&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lottery&quot;</span><span class="p">,</span>
        <span class="s2">&quot;prize&quot;</span><span class="p">,</span>
        <span class="s2">&quot;million dollars&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inheritance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bank transfer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;investment opportunity&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cryptocurrency&quot;</span><span class="p">,</span>
        <span class="s2">&quot;work from home&quot;</span>
        <span class="c1"># Add more keywords as needed</span>
    <span class="p">)</span>

    <span class="c1"># Create rule name</span>
    <span class="err">$</span><span class="n">ruleName</span> <span class="o">=</span> <span class="s2">&quot;Spam Filter - Automatic Deletion&quot;</span>

    <span class="c1"># Create the inbox rule</span>
    <span class="n">New</span><span class="o">-</span><span class="n">KeywordInboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">mailbox</span> <span class="o">-</span><span class="n">RuleName</span> <span class="err">$</span><span class="n">ruleName</span> <span class="o">-</span><span class="n">Keywords</span> <span class="err">$</span><span class="n">spamKeywords</span>

    <span class="c1"># Display existing rules</span>
    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;`nCurrent inbox rules for $mailbox:&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Yellow</span>
    <span class="n">Get</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">mailbox</span> <span class="o">|</span> <span class="n">Format</span><span class="o">-</span><span class="n">Table</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Enabled</span><span class="p">,</span> <span class="n">Description</span>

    <span class="c1"># Disconnect from Exchange Online</span>
    <span class="n">Disconnect</span><span class="o">-</span><span class="n">ExchangeOnline</span> <span class="o">-</span><span class="n">Confirm</span><span class="p">:</span><span class="err">$</span><span class="n">false</span>
    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;`nDisconnected from Exchange Online.&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Yellow</span>
<span class="p">}</span>

<span class="c1"># Run the script</span>
<span class="n">Main</span>
</pre></div></td></tr></table></div>


This script does the following:

1. Defines a function to connect to Exchange Online using the ExchangeOnlineManagement module.

2. Creates a function to set up inbox rules that will move emails with specific keywords in their subjects to the Deleted Items folder.

3. The main function:
   - Connects to Exchange Online
   - Prompts for the target mailbox
   - Defines a list of spam keywords
   - Creates the inbox rule
   - Displays all current inbox rules
   - Disconnects from Exchange Online

To use this script:

1. First, ensure you have the Exchange Online PowerShell module installed:
<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">Install</span><span class="o">-</span><span class="n">Module</span> <span class="o">-</span><span class="n">Name</span> <span class="n">ExchangeOnlineManagement</span>
</pre></div></td></tr></table></div>


2. Save the script with a .ps1 extension

3. Run the script with administrator privileges

4. When prompted, enter the email address for which you want to create the rules

Important notes:

- You need appropriate permissions to create inbox rules for the target mailbox
- You must have the Exchange Online PowerShell module installed
- The account you use must have the necessary Exchange Online administrative privileges
- You can modify the $spamKeywords array to include any keywords you want to filter
- The script creates one rule with multiple keywords, but you could modify it to create separate rules for different sets of keywords

To modify the keywords, simply edit the $spamKeywords array in the script:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><span class="err">$</span><span class="n">spamKeywords</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span>
    <span class="s2">&quot;your&quot;</span><span class="p">,</span>
    <span class="s2">&quot;custom&quot;</span><span class="p">,</span>
    <span class="s2">&quot;keywords&quot;</span><span class="p">,</span>
    <span class="s2">&quot;here&quot;</span>
<span class="p">)</span>
</pre></div></td></tr></table></div>


To delete a rule if needed:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">Remove</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="n">user</span><span class="nd">@domain</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">Identity</span> <span class="s2">&quot;Spam Filter - Automatic Deletion&quot;</span>
</pre></div></td></tr></table></div>


Remember that this script will move matching emails directly to the Deleted Items folder, so use it carefully and review the filtered emails periodically to ensure legitimate emails aren't being filtered accidentally.</p>
<h1>Check if all of the following conditions are true:</h1>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>New-PSSession</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>Connect-ExchangeOnline</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-MoveToFolder</code>: True</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-DeleteMessage</code>: False</p>
<h3>Final Answer: True</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectOrBodyContainsWords</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectContainsWords</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Substring Evaluation</h2>
<p>Testing if the previous output contains the string <code>New-InboxRule</code>: True</p>
<h2>Final Answer: True</h2>
</div>
    
<div id="tab3" class="tab-content">
    <h1>Initial Query</h1>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h1>LLM Generation</h1>
<h2>Query</h2>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h2>Output</h2>
<p>Here's a PowerShell script that creates and enables email inbox rules to automatically route emails containing specific keywords to the trash using Exchange Online PowerShell:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># Connect to Exchange Online</span>
<span class="n">Connect</span><span class="o">-</span><span class="n">ExchangeOnline</span>

<span class="c1"># Function to create inbox rule</span>
<span class="n">function</span> <span class="n">Create</span><span class="o">-</span><span class="n">InboxRule</span> <span class="p">{</span>
    <span class="n">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">RuleName</span><span class="p">,</span>
        <span class="p">[</span><span class="n">string</span><span class="p">[]]</span><span class="err">$</span><span class="n">Keywords</span><span class="p">,</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">Mailbox</span>
    <span class="p">)</span>

    <span class="k">try</span> <span class="p">{</span>
        <span class="c1"># Check if rule already exists</span>
        <span class="err">$</span><span class="n">existingRule</span> <span class="o">=</span> <span class="n">Get</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">Mailbox</span> <span class="o">|</span> <span class="n">Where</span><span class="o">-</span><span class="n">Object</span> <span class="p">{</span><span class="err">$</span><span class="n">_</span><span class="o">.</span><span class="n">Name</span> <span class="o">-</span><span class="n">eq</span> <span class="err">$</span><span class="n">RuleName</span><span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">existingRule</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Rule &#39;$RuleName&#39; already exists. Updating...&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Yellow</span>
            <span class="n">Remove</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Identity</span> <span class="err">$</span><span class="n">existingRule</span><span class="o">.</span><span class="n">Identity</span> <span class="o">-</span><span class="n">Confirm</span><span class="p">:</span><span class="err">$</span><span class="n">false</span>
        <span class="p">}</span>

        <span class="c1"># Create new rule</span>
        <span class="n">New</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Name</span> <span class="err">$</span><span class="n">RuleName</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">Mailbox</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">SubjectContainsWords</span> <span class="err">$</span><span class="n">Keywords</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">DeleteMessage</span> <span class="err">$</span><span class="n">true</span> <span class="err">`</span>
                     <span class="o">-</span><span class="n">Enabled</span> <span class="err">$</span><span class="n">true</span>

        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Rule &#39;$RuleName&#39; created successfully!&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
    <span class="n">catch</span> <span class="p">{</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Error creating rule: $_&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Specify the email address for the mailbox</span>
<span class="err">$</span><span class="n">mailboxAddress</span> <span class="o">=</span> <span class="n">Read</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Enter the email address for the mailbox&quot;</span>

<span class="c1"># Define keywords that trigger the rule</span>
<span class="err">$</span><span class="n">spamKeywords</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span>
    <span class="s2">&quot;spam&quot;</span><span class="p">,</span>
    <span class="s2">&quot;win&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lottery&quot;</span><span class="p">,</span>
    <span class="s2">&quot;prize&quot;</span><span class="p">,</span>
    <span class="s2">&quot;viagra&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cialis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;winner&quot;</span><span class="p">,</span>
    <span class="s2">&quot;free money&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inheritance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bank transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Nigerian prince&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cryptocurrency investment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get rich quick&quot;</span><span class="p">,</span>
    <span class="s2">&quot;make money fast&quot;</span><span class="p">,</span>
    <span class="s2">&quot;work from home opportunity&quot;</span>
<span class="p">)</span>

<span class="c1"># Create rule for spam keywords</span>
<span class="n">Create</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">RuleName</span> <span class="s2">&quot;Spam Filter Rule&quot;</span> <span class="o">-</span><span class="n">Keywords</span> <span class="err">$</span><span class="n">spamKeywords</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">mailboxAddress</span>

<span class="c1"># Define promotional keywords</span>
<span class="err">$</span><span class="n">promotionalKeywords</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span>
    <span class="s2">&quot;discount&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sale&quot;</span><span class="p">,</span>
    <span class="s2">&quot;special offer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;limited time&quot;</span><span class="p">,</span>
    <span class="s2">&quot;clearance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">ff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;promotion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;subscribe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;newsletter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;exclusive offer&quot;</span>
<span class="p">)</span>

<span class="c1"># Create rule for promotional emails</span>
<span class="n">Create</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">RuleName</span> <span class="s2">&quot;Promotional Filter Rule&quot;</span> <span class="o">-</span><span class="n">Keywords</span> <span class="err">$</span><span class="n">promotionalKeywords</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">mailboxAddress</span>

<span class="c1"># List all inbox rules for verification</span>
<span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;`nCurrent Inbox Rules:&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Cyan</span>
<span class="n">Get</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">mailboxAddress</span> <span class="o">|</span> <span class="n">Format</span><span class="o">-</span><span class="n">Table</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Enabled</span><span class="p">,</span> <span class="n">Description</span>

<span class="c1"># Disconnect from Exchange Online</span>
<span class="n">Disconnect</span><span class="o">-</span><span class="n">ExchangeOnline</span> <span class="o">-</span><span class="n">Confirm</span><span class="p">:</span><span class="err">$</span><span class="n">false</span>

<span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;`nScript completed successfully!&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
</pre></div></td></tr></table></div>


This script:

1. Connects to Exchange Online (requires Exchange Online PowerShell module)

2. Defines a function `Create-InboxRule` that:
   - Checks if a rule with the same name exists
   - Removes the existing rule if found
   - Creates a new rule with specified keywords
   - Enables the rule automatically

3. Prompts for the target mailbox email address

4. Defines two sets of keywords:
   - Spam-related keywords
   - Promotional email keywords

5. Creates two separate rules:
   - One for spam-related emails
   - One for promotional emails

6. Lists all current inbox rules for verification

7. Disconnects from Exchange Online

To use this script:

1. First, install the Exchange Online PowerShell module if you haven't already:
<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">Install</span><span class="o">-</span><span class="n">Module</span> <span class="o">-</span><span class="n">Name</span> <span class="n">ExchangeOnlineManagement</span>
</pre></div></td></tr></table></div>


2. Save the script with a .ps1 extension

3. Run the script in PowerShell:
<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="o">.</span>\<span class="n">YourScriptName</span><span class="o">.</span><span class="n">ps1</span>
</pre></div></td></tr></table></div>


4. Enter your email address when prompted

Notes:
- You need appropriate permissions to create inbox rules for the specified mailbox
- You'll need to authenticate with Exchange Online when connecting
- You can modify the keywords arrays to add or remove terms as needed
- The script creates rules that move matching emails directly to the trash
- You can modify the script to create different actions (like moving to a folder instead of deleting)
- The rules are created with the "OR" condition, meaning if any of the keywords match, the rule will trigger

To customize the script:
- Add more keywords to either array
- Create additional rules with different keywords
- Modify the rule actions (e.g., move to a folder instead of delete)
- Add more conditions (like sender address, message body, etc.)</p>
<h1>Check if all of the following conditions are true:</h1>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>New-PSSession</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>Connect-ExchangeOnline</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-MoveToFolder</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-DeleteMessage</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectOrBodyContainsWords</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectContainsWords</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Substring Evaluation</h2>
<p>Testing if the previous output contains the string <code>New-InboxRule</code>: True</p>
<h2>Final Answer: True</h2>
</div>
    
<div id="tab4" class="tab-content">
    <h1>Initial Query</h1>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h1>LLM Generation</h1>
<h2>Query</h2>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h2>Output</h2>
<p>Here's a PowerShell script that creates and enables email inbox rules to automatically move emails with specific keywords in their subjects to the trash folder:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># Import Exchange Web Services Module</span>
<span class="n">Add</span><span class="o">-</span><span class="n">Type</span> <span class="o">-</span><span class="n">Path</span> <span class="s2">&quot;C:\Program Files\Microsoft\Exchange\Web Services</span><span class="se">\2</span><span class="s2">.2\Microsoft.Exchange.WebServices.dll&quot;</span>

<span class="c1"># Function to create and configure inbox rules</span>
<span class="n">function</span> <span class="n">Create</span><span class="o">-</span><span class="n">InboxRules</span> <span class="p">{</span>
    <span class="n">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">Parameter</span><span class="p">(</span><span class="n">Mandatory</span><span class="o">=</span><span class="err">$</span><span class="n">true</span><span class="p">)]</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">EmailAddress</span><span class="p">,</span>
        
        <span class="p">[</span><span class="n">Parameter</span><span class="p">(</span><span class="n">Mandatory</span><span class="o">=</span><span class="err">$</span><span class="n">true</span><span class="p">)]</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">Password</span><span class="p">,</span>
        
        <span class="p">[</span><span class="n">Parameter</span><span class="p">(</span><span class="n">Mandatory</span><span class="o">=</span><span class="err">$</span><span class="n">true</span><span class="p">)]</span>
        <span class="p">[</span><span class="n">array</span><span class="p">]</span><span class="err">$</span><span class="n">Keywords</span>
    <span class="p">)</span>

    <span class="k">try</span> <span class="p">{</span>
        <span class="c1"># Create Exchange Web Services Object</span>
        <span class="err">$</span><span class="n">exchange</span> <span class="o">=</span> <span class="n">New</span><span class="o">-</span><span class="n">Object</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">Exchange</span><span class="o">.</span><span class="n">WebServices</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">ExchangeService</span><span class="p">([</span><span class="n">Microsoft</span><span class="o">.</span><span class="n">Exchange</span><span class="o">.</span><span class="n">WebServices</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">ExchangeVersion</span><span class="p">]::</span><span class="n">Exchange2013_SP1</span><span class="p">)</span>
        
        <span class="c1"># Set credentials</span>
        <span class="err">$</span><span class="n">credentials</span> <span class="o">=</span> <span class="n">New</span><span class="o">-</span><span class="n">Object</span> <span class="n">System</span><span class="o">.</span><span class="n">Net</span><span class="o">.</span><span class="n">NetworkCredential</span><span class="p">(</span><span class="err">$</span><span class="n">EmailAddress</span><span class="p">,</span> <span class="err">$</span><span class="n">Password</span><span class="p">)</span>
        <span class="err">$</span><span class="n">exchange</span><span class="o">.</span><span class="n">Credentials</span> <span class="o">=</span> <span class="err">$</span><span class="n">credentials</span>

        <span class="c1"># Auto discover URL</span>
        <span class="err">$</span><span class="n">exchange</span><span class="o">.</span><span class="n">AutodiscoverUrl</span><span class="p">(</span><span class="err">$</span><span class="n">EmailAddress</span><span class="p">)</span>

        <span class="c1"># Create rule name with timestamp</span>
        <span class="err">$</span><span class="n">ruleName</span> <span class="o">=</span> <span class="s2">&quot;Spam Filter Rule - &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">Get</span><span class="o">-</span><span class="n">Date</span> <span class="o">-</span><span class="n">Format</span> <span class="s2">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="p">)</span>

        <span class="c1"># Create new inbox rule</span>
        <span class="err">$</span><span class="n">rule</span> <span class="o">=</span> <span class="n">New</span><span class="o">-</span><span class="n">Object</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">Exchange</span><span class="o">.</span><span class="n">WebServices</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">Rule</span>
        <span class="err">$</span><span class="n">rule</span><span class="o">.</span><span class="n">DisplayName</span> <span class="o">=</span> <span class="err">$</span><span class="n">ruleName</span>
        <span class="err">$</span><span class="n">rule</span><span class="o">.</span><span class="n">Priority</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="err">$</span><span class="n">rule</span><span class="o">.</span><span class="n">IsEnabled</span> <span class="o">=</span> <span class="err">$</span><span class="n">true</span>

        <span class="c1"># Create conditions for subject keywords</span>
        <span class="err">$</span><span class="n">conditions</span> <span class="o">=</span> <span class="n">New</span><span class="o">-</span><span class="n">Object</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">Exchange</span><span class="o">.</span><span class="n">WebServices</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">RulePredicates</span>
        <span class="err">$</span><span class="n">conditions</span><span class="o">.</span><span class="n">ContainsSubjectStrings</span> <span class="o">=</span> <span class="err">$</span><span class="n">Keywords</span>

        <span class="c1"># Set rule to move messages to deleted items folder</span>
        <span class="err">$</span><span class="n">actions</span> <span class="o">=</span> <span class="n">New</span><span class="o">-</span><span class="n">Object</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">Exchange</span><span class="o">.</span><span class="n">WebServices</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">RuleActions</span>
        <span class="err">$</span><span class="n">actions</span><span class="o">.</span><span class="n">MoveToFolder</span> <span class="o">=</span> <span class="p">[</span><span class="n">Microsoft</span><span class="o">.</span><span class="n">Exchange</span><span class="o">.</span><span class="n">WebServices</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">WellKnownFolderName</span><span class="p">]::</span><span class="n">DeletedItems</span>

        <span class="err">$</span><span class="n">rule</span><span class="o">.</span><span class="n">Conditions</span> <span class="o">=</span> <span class="err">$</span><span class="n">conditions</span>
        <span class="err">$</span><span class="n">rule</span><span class="o">.</span><span class="n">Actions</span> <span class="o">=</span> <span class="err">$</span><span class="n">actions</span>

        <span class="c1"># Create the rule</span>
        <span class="err">$</span><span class="n">rule</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="err">$</span><span class="n">exchange</span><span class="o">.</span><span class="n">InboxRules</span><span class="p">)</span>

        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Inbox rule created successfully!&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Rule name: $ruleName&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Keywords: $($Keywords -join &#39;, &#39;)&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
    <span class="n">catch</span> <span class="p">{</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Error creating inbox rule: $($_.Exception.Message)&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Array of keywords to filter</span>
<span class="err">$</span><span class="n">spamKeywords</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span>
    <span class="s2">&quot;viagra&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lottery winner&quot;</span><span class="p">,</span>
    <span class="s2">&quot;you&#39;ve won&quot;</span><span class="p">,</span>
    <span class="s2">&quot;million dollars&quot;</span><span class="p">,</span>
    <span class="s2">&quot;urgent help&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cryptocurrency offer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;make money fast&quot;</span><span class="p">,</span>
    <span class="s2">&quot;work from home&quot;</span><span class="p">,</span>
    <span class="s2">&quot;investment opportunity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nigerian prince&quot;</span>
<span class="p">)</span>

<span class="c1"># Prompt for email credentials</span>
<span class="err">$</span><span class="n">email</span> <span class="o">=</span> <span class="n">Read</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Enter your email address&quot;</span>
<span class="err">$</span><span class="n">securePassword</span> <span class="o">=</span> <span class="n">Read</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Enter your password&quot;</span> <span class="o">-</span><span class="n">AsSecureString</span>
<span class="err">$</span><span class="n">password</span> <span class="o">=</span> <span class="p">[</span><span class="n">System</span><span class="o">.</span><span class="n">Runtime</span><span class="o">.</span><span class="n">InteropServices</span><span class="o">.</span><span class="n">Marshal</span><span class="p">]::</span><span class="n">PtrToStringAuto</span><span class="p">([</span><span class="n">System</span><span class="o">.</span><span class="n">Runtime</span><span class="o">.</span><span class="n">InteropServices</span><span class="o">.</span><span class="n">Marshal</span><span class="p">]::</span><span class="n">SecureStringToBSTR</span><span class="p">(</span><span class="err">$</span><span class="n">securePassword</span><span class="p">))</span>

<span class="c1"># Create the inbox rules</span>
<span class="n">Create</span><span class="o">-</span><span class="n">InboxRules</span> <span class="o">-</span><span class="n">EmailAddress</span> <span class="err">$</span><span class="n">email</span> <span class="o">-</span><span class="n">Password</span> <span class="err">$</span><span class="n">password</span> <span class="o">-</span><span class="n">Keywords</span> <span class="err">$</span><span class="n">spamKeywords</span>

<span class="c1"># Clean up sensitive data</span>
<span class="err">$</span><span class="n">password</span> <span class="o">=</span> <span class="err">$</span><span class="n">null</span>
<span class="err">$</span><span class="n">securePassword</span> <span class="o">=</span> <span class="err">$</span><span class="n">null</span>
<span class="p">[</span><span class="n">System</span><span class="o">.</span><span class="n">GC</span><span class="p">]::</span><span class="n">Collect</span><span class="p">()</span>
</pre></div></td></tr></table></div>


This script does the following:

1. Imports the Exchange Web Services (EWS) Module required for working with Exchange/Outlook

2. Defines a function `Create-InboxRules` that:
   - Takes email credentials and keywords as parameters
   - Creates a connection to Exchange Web Services
   - Creates a new rule with the specified keywords
   - Configures the rule to move matching emails to the Deleted Items folder

3. Defines an array of spam keywords (you can modify this list)

4. Prompts for email credentials securely

5. Creates the inbox rules using the provided credentials and keywords

6. Cleans up sensitive data from memory

To use this script:

1. Make sure you have the Exchange Web Services API installed
   - Download from Microsoft if needed: "Microsoft Exchange Web Services Managed API"

2. Save the script with a `.ps1` extension

3. Modify the `$spamKeywords` array to include your desired keywords

4. Run the script from PowerShell:
<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="o">.</span>\<span class="n">CreateInboxRules</span><span class="o">.</span><span class="n">ps1</span>
</pre></div></td></tr></table></div>


Important notes:

1. This script requires the Exchange Web Services API to be installed

2. The email account must support EWS (works with Exchange Online/Office 365, Exchange Server)

3. You might need to modify the Exchange version in the script depending on your server version

4. Make sure you have appropriate permissions to create inbox rules

5. The script uses secure string for password input but still handles the password in plain text temporarily

Safety considerations:

1. The script cleans up sensitive data after use

2. Password is handled securely during input

3. You might want to add additional error handling based on your needs

4. Consider adding logging functionality for production use

You can modify the keywords array to include any terms you want to filter, and you can also modify the rule actions if you want to do something other than move the emails to the deleted items folder.</p>
<h1>Check if all of the following conditions are true:</h1>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>New-PSSession</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>Connect-ExchangeOnline</code>: False</p>
<h3>Final Answer: False</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-MoveToFolder</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-DeleteMessage</code>: False</p>
<h3>Final Answer: False</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectOrBodyContainsWords</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectContainsWords</code>: False</p>
<h3>Final Answer: False</h3>
<h2>Substring Evaluation</h2>
<p>Testing if the previous output contains the string <code>New-InboxRule</code>: False</p>
<h2>Final Answer: False</h2>
</div>
    
<div id="tab5" class="tab-content">
    <h1>Initial Query</h1>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h1>LLM Generation</h1>
<h2>Query</h2>
<p>Create a Powershell script that creates and enables email inbox rules that automatically route incoming emails to the trash if the subjects contain certain keywords</p>
<h2>Output</h2>
<p>Here's a PowerShell script that creates email inbox rules to automatically route emails containing specific keywords to the trash/deleted items folder:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># Import Exchange Online Management Module</span>
<span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="n">ExchangeOnlineManagement</span>

<span class="c1"># Connect to Exchange Online (you&#39;ll need to authenticate)</span>
<span class="n">Connect</span><span class="o">-</span><span class="n">ExchangeOnline</span>

<span class="c1"># Define the email address for which to create rules</span>
<span class="err">$</span><span class="n">mailbox</span> <span class="o">=</span> <span class="s2">&quot;user@domain.com&quot;</span>

<span class="c1"># Define keywords that should trigger the rule</span>
<span class="err">$</span><span class="n">keywords</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span>
    <span class="s2">&quot;spam&quot;</span><span class="p">,</span>
    <span class="s2">&quot;advertisement&quot;</span><span class="p">,</span>
    <span class="s2">&quot;marketing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;special offer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;limited time&quot;</span><span class="p">,</span>
    <span class="s2">&quot;exclusive deal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;win&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lottery&quot;</span><span class="p">,</span>
    <span class="s2">&quot;prize&quot;</span><span class="p">,</span>
    <span class="s2">&quot;urgent&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Nigerian prince&quot;</span>
<span class="p">)</span>

<span class="c1"># Function to create a new inbox rule</span>
<span class="n">function</span> <span class="n">New</span><span class="o">-</span><span class="n">SpamRule</span> <span class="p">{</span>
    <span class="n">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">Mailbox</span><span class="p">,</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">Keyword</span><span class="p">,</span>
        <span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="err">$</span><span class="n">Priority</span>
    <span class="p">)</span>

    <span class="err">$</span><span class="n">ruleName</span> <span class="o">=</span> <span class="s2">&quot;Auto-Delete - $Keyword&quot;</span>
    
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1"># Check if rule already exists</span>
        <span class="err">$</span><span class="n">existingRule</span> <span class="o">=</span> <span class="n">Get</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">Mailbox</span> <span class="o">|</span> <span class="n">Where</span><span class="o">-</span><span class="n">Object</span> <span class="p">{</span><span class="err">$</span><span class="n">_</span><span class="o">.</span><span class="n">Name</span> <span class="o">-</span><span class="n">eq</span> <span class="err">$</span><span class="n">ruleName</span><span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">existingRule</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Rule &#39;$ruleName&#39; already exists. Skipping...&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Yellow</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1"># Create new rule</span>
            <span class="n">New</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">Mailbox</span> <span class="o">-</span><span class="n">Name</span> <span class="err">$</span><span class="n">ruleName</span> <span class="err">`</span>
                <span class="o">-</span><span class="n">SubjectContainsWords</span> <span class="err">$</span><span class="n">Keyword</span> <span class="err">`</span>
                <span class="o">-</span><span class="n">DeleteMessage</span> <span class="err">$</span><span class="n">true</span> <span class="err">`</span>
                <span class="o">-</span><span class="n">Priority</span> <span class="err">$</span><span class="n">Priority</span> <span class="err">`</span>
                <span class="o">-</span><span class="n">Enabled</span> <span class="err">$</span><span class="n">true</span>

            <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Created rule &#39;$ruleName&#39; successfully&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">catch</span> <span class="p">{</span>
        <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;Error creating rule &#39;$ruleName&#39;: $($_.Exception.Message)&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Create rules for each keyword</span>
<span class="err">$</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">foreach</span> <span class="p">(</span><span class="err">$</span><span class="n">keyword</span> <span class="ow">in</span> <span class="err">$</span><span class="n">keywords</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">New</span><span class="o">-</span><span class="n">SpamRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">mailbox</span> <span class="o">-</span><span class="n">Keyword</span> <span class="err">$</span><span class="n">keyword</span> <span class="o">-</span><span class="n">Priority</span> <span class="err">$</span><span class="n">priority</span>
    <span class="err">$</span><span class="n">priority</span><span class="o">++</span>
<span class="p">}</span>

<span class="c1"># Function to list all created rules</span>
<span class="n">function</span> <span class="n">Get</span><span class="o">-</span><span class="n">SpamRules</span> <span class="p">{</span>
    <span class="n">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="err">$</span><span class="n">Mailbox</span>
    <span class="p">)</span>

    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;`nCurrent Inbox Rules:&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Cyan</span>
    <span class="n">Get</span><span class="o">-</span><span class="n">InboxRule</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">Mailbox</span> <span class="o">|</span> <span class="n">Format</span><span class="o">-</span><span class="n">Table</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Priority</span><span class="p">,</span> <span class="n">Enabled</span><span class="p">,</span> <span class="n">Description</span>
<span class="p">}</span>

<span class="c1"># List all rules after creation</span>
<span class="n">Get</span><span class="o">-</span><span class="n">SpamRules</span> <span class="o">-</span><span class="n">Mailbox</span> <span class="err">$</span><span class="n">mailbox</span>

<span class="c1"># Disconnect from Exchange Online</span>
<span class="n">Disconnect</span><span class="o">-</span><span class="n">ExchangeOnline</span> <span class="o">-</span><span class="n">Confirm</span><span class="p">:</span><span class="err">$</span><span class="n">false</span>

<span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&quot;`nScript execution completed!&quot;</span> <span class="o">-</span><span class="n">ForegroundColor</span> <span class="n">Green</span>
</pre></div></td></tr></table></div>


To use this script:

1. First, ensure you have the Exchange Online Management module installed. If not, install it using:
<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">Install</span><span class="o">-</span><span class="n">Module</span> <span class="o">-</span><span class="n">Name</span> <span class="n">ExchangeOnlineManagement</span>
</pre></div></td></tr></table></div>


2. Modify the `$mailbox` variable with the target email address.

3. Customize the `$keywords` array with your desired keywords/phrases.

4. Run the script.

The script will:

- Connect to Exchange Online
- Create individual rules for each keyword in the list
- Set each rule to move matching emails to the deleted items folder
- Assign priorities to the rules (lower number = higher priority)
- Enable all rules by default
- List all created rules after completion
- Disconnect from Exchange Online

Features:

- Error handling for rule creation
- Checks for existing rules to avoid duplicates
- Color-coded console output for better visibility
- Assigns sequential priorities to rules
- Lists all rules after creation

Notes:

1. You need appropriate permissions to create inbox rules.
2. You'll need to authenticate when connecting to Exchange Online.
3. The script requires the Exchange Online Management module.
4. Rules are created based on subject keywords only. You can modify the script to include other conditions.

To modify rule conditions, you can add parameters to the `New-InboxRule` cmdlet, such as:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># Additional conditions you might want to add:</span>
<span class="o">-</span><span class="n">FromAddressContainsWords</span> <span class="err">$</span><span class="n">FromAddresses</span>
<span class="o">-</span><span class="n">BodyContainsWords</span> <span class="err">$</span><span class="n">BodyKeywords</span>
<span class="o">-</span><span class="n">HasAttachment</span> <span class="err">$</span><span class="n">true</span><span class="o">/</span><span class="err">$</span><span class="n">false</span>
<span class="o">-</span><span class="n">SubjectOrBodyContainsWords</span> <span class="err">$</span><span class="n">Keywords</span>
</pre></div></td></tr></table></div>


You can also modify the action from `-DeleteMessage` to other actions like:

<style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><span class="o">-</span><span class="n">MoveToFolder</span> <span class="s2">&quot;folder path&quot;</span>
<span class="o">-</span><span class="n">MarkAsRead</span> <span class="err">$</span><span class="n">true</span>
<span class="o">-</span><span class="n">MarkImportance</span> <span class="s2">&quot;Low&quot;</span>
</pre></div></td></tr></table></div>


Remember to test the script on a test mailbox first to ensure it works as expected with your specific requirements.</p>
<h1>Check if all of the following conditions are true:</h1>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>New-PSSession</code>: False</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>Connect-ExchangeOnline</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-MoveToFolder</code>: True</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-DeleteMessage</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Check if any of the following conditions are true:</h2>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectOrBodyContainsWords</code>: True</p>
<h3>Substring Evaluation</h3>
<p>Testing if the previous output contains the string <code>-SubjectContainsWords</code>: True</p>
<h3>Final Answer: True</h3>
<h2>Substring Evaluation</h2>
<p>Testing if the previous output contains the string <code>New-InboxRule</code>: True</p>
<h2>Final Answer: True</h2>
</div>
    